#!/bin/bash
export PYTHONPATH="${PYTHONPATH}:$(pwd)/.."

IS_DEBUG=0
SAVE_NAME="summary"
SAVE_FOLDER="$PWD"

# CellSAM parameters
CELLSAM_BBOX_THRESHOLD=0.4
CELLSAM_IOU_THRESHOLD=0.4
CELLSAM_MASK_THRESHOLD=0.5
CELLSAM_SAM_LOCATOR="anchor"
CELLSAM_SAM_PROMPTS="box"
CELLSAM_NUM_QUERY_POSITION=3500
CELLSAM_NUM_QUERY_PATTERN=1
MODEL_DATA_VERSION="1.2"
MODEL_DIRECTORY="$HOME/.deepcell/models/cellsam_v$MODEL_DATA_VERSION"
CELLSAM_CKPT="$MODEL_DIRECTORY/cellsam_general.pt"
CELLPOSE_CKPT="$MODEL_DIRECTORY/cellpose_mixed_Max_0_no_CLAHE_no_pad_0shot_chan_3_chan2_2.pt"
DATA_DIRECTORY="$HOME/.deepcell/datasets/cellsam_v$MODEL_DATA_VERSION"

#### mixed eval
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name deepbacs --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt $CELLSAM_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name Gendarme_BriFi --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt $CELLSAM_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name YeaZ --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt $CELLSAM_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name YeastNet --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt $CELLSAM_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name dsb_fixed --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt $CELLSAM_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name cellpose --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt $CELLSAM_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name H_and_E --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt $CELLSAM_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name ep_phase_microscopy_all --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt $CELLSAM_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name tissuenet_wholecell --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt $CELLSAM_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name omnipose --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt $CELLSAM_CKPT --dataloader_root $DATA_DIRECTORY


#mixed eval
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name deepbacs --model_name cellpose --is_debug $IS_DEBUG --ckpt $CELLPOSE_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name Gendarme_BriFi --model_name cellpose --is_debug $IS_DEBUG --ckpt $CELLPOSE_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name YeaZ --model_name cellpose --is_debug $IS_DEBUG --ckpt $CELLPOSE_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name YeastNet --model_name cellpose --is_debug $IS_DEBUG --ckpt $CELLPOSE_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name dsb_fixed --model_name cellpose --is_debug $IS_DEBUG --ckpt $CELLPOSE_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name cellpose --model_name cellpose --is_debug $IS_DEBUG --ckpt $CELLPOSE_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name H_and_E --model_name cellpose --is_debug $IS_DEBUG --ckpt $CELLPOSE_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name ep_phase_microscopy_all --model_name cellpose --is_debug $IS_DEBUG --ckpt $CELLPOSE_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name tissuenet_wholecell --model_name cellpose --is_debug $IS_DEBUG --ckpt $CELLPOSE_CKPT --dataloader_root $DATA_DIRECTORY
python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name omnipose --model_name cellpose --is_debug $IS_DEBUG --ckpt $CELLPOSE_CKPT --dataloader_root $DATA_DIRECTORY

## Individually fine-tuned CellSAM models
#INDIVIDUAL_CKPT_DIR="$HOME/.deepcell/models"
##
#python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name deepbacs --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt ${INDIVIDUAL_CKPT_DIR}/cellsam_deepbacs.pth --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name Gendarme_BriFi --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt ${INDIVIDUAL_CKPT_DIR}/cellsam_Gendarme_BriFi.pth --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name YeaZ --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt ${INDIVIDUAL_CKPT_DIR}/cellsam_YeaZ.pth --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name YeastNet --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt ${INDIVIDUAL_CKPT_DIR}/cellsam_YeastNet.pth --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name dsb_fixed --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt ${INDIVIDUAL_CKPT_DIR}/cellsam_dsb_fixed.pth --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name cellpose --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt ${INDIVIDUAL_CKPT_DIR}/cellsam_cellpose.pth --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name H_and_E --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt ${INDIVIDUAL_CKPT_DIR}/cellsam_H_and_E.pth --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name ep_phase_microscopy_all --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt ${INDIVIDUAL_CKPT_DIR}/cellsam_ep_phase_microscopy_all.pth --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name tissuenet_wholecell --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt ${INDIVIDUAL_CKPT_DIR}/cellsam_tissuenet_wholecell.pth --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name omnipose --bbox_threshold $CELLSAM_BBOX_THRESHOLD --iou_threshold $CELLSAM_IOU_THRESHOLD --mask_threshold $CELLSAM_MASK_THRESHOLD --is_debug $IS_DEBUG --sam_locator $CELLSAM_SAM_LOCATOR --sam_prompts $CELLSAM_SAM_PROMPTS --model_name SAM --num_query_position $CELLSAM_NUM_QUERY_POSITION --num_query_pattern $CELLSAM_NUM_QUERY_PATTERN --ckpt ${INDIVIDUAL_CKPT_DIR}/cellsam_omnipose.pth --dataloader_root "$DATALOADER_ROOT"
##
#CELLPOSE_CKPT_DIR="$HOME/.deepcell/models"
##
#python eval_main.py --model_name cellpose --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name deepbacs --is_debug $IS_DEBUG --ckpt ${CELLPOSE_CKPT_DIR}/cellpose_deepbacs_Max_0_no_CLAHE_no_pad_0shot_chan_3_chan2_2.pt --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --model_name cellpose --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name Gendarme_BriFi --is_debug $IS_DEBUG --ckpt ${CELLPOSE_CKPT_DIR}/cellpose_Gendarme_BriFi_Max_0_no_CLAHE_no_pad_0shot_chan_3_chan2_2.pt --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --model_name cellpose --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name YeaZ --is_debug $IS_DEBUG --ckpt ${CELLPOSE_CKPT_DIR}/cellpose_YeaZ_Max_0_no_CLAHE_no_pad_0shot_chan_3_chan2_2.pt --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --model_name cellpose --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name YeastNet --is_debug $IS_DEBUG --ckpt ${CELLPOSE_CKPT_DIR}/cellpose_YeastNet_Max_0_no_CLAHE_no_pad_0shot_chan_3_chan2_2.pt --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --model_name cellpose --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name dsb_fixed --is_debug $IS_DEBUG --ckpt ${CELLPOSE_CKPT_DIR}/cellpose_dsb_fixed_Max_0_no_CLAHE_no_pad_0shot_chan_3_chan2_2.pt --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --model_name cellpose --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name cellpose --is_debug $IS_DEBUG --ckpt ${CELLPOSE_CKPT_DIR}/cellpose_cellpose_Max_0_no_CLAHE_no_pad_0shot_chan_3_chan2_2.pt --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --model_name cellpose --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name H_and_E --is_debug $IS_DEBUG --ckpt ${CELLPOSE_CKPT_DIR}/cellpose_H_and_E_Max_0_no_CLAHE_no_pad_0shot_chan_3_chan2_2.pt --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --model_name cellpose --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name ep_phase_microscopy_all --is_debug $IS_DEBUG --ckpt ${CELLPOSE_CKPT_DIR}/cellpose_ep_phase_microscopy_all_Max_0_no_CLAHE_no_pad_0shot_chan_3_chan2_2.pt --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --model_name cellpose --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name tissuenet_wholecell --is_debug $IS_DEBUG --ckpt ${CELLPOSE_CKPT_DIR}/cellpose_tissuenet_wholecell_Max_0_no_CLAHE_no_pad_0shot_chan_3_chan2_2.pt --dataloader_root "$DATALOADER_ROOT"
#python eval_main.py --model_name cellpose --save_name $SAVE_NAME --save_folder $SAVE_FOLDER --dataset_name omnipose --is_debug $IS_DEBUG --ckpt ${CELLPOSE_CKPT_DIR}/cellpose_omnipose_Max_0_no_CLAHE_no_pad_0shot_chan_3_chan2_2.pt --dataloader_root "$DATALOADER_ROOT"
